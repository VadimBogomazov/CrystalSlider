"use strict";var _createClass=(()=>{function a(b,c){for(var i=0,d;i<c.length;i++){d=c[i];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(b,d.key,d)}}return(b,c,d)=>{if(c)a(b.prototype,c);if(d)a(b,d);return b}})();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(a){"use strict";var g=document,h=d(),j=f(),k=function(){function l(m){_classCallCheck(this,l);l._count=(l._count||0)+1;var n="crystal-slider",o={selector:".crystal-slider",activeSlide:1,loop:!0,duration:500,draggable:!0,threshold:30,keyboard:!1,easing:"ease-out",nav:!0,navPrevVal:"Prev",navNextVal:"Next",pagination:!0,onReady:()=>{},beforeChange:()=>{},afterChange:()=>{}},t=this;t.options=Object.assign(o,m);t._id=""+("crystal-slider-"+l._count);t._slider=g.querySelector(t.options.selector);if(t._slider===null){throw new Error("Selector "+t.options.selector+" does not exist")}t._sliderWidth=t._slider.getBoundingClientRect().width;t._slides=Array.from(t._slider.children);t._isTouchDevice=c();t._isMove=!1;t._isTouched=!1;t._container=null;t._track=null;t._nav=null;t._pagination=null;t._transformX=null;t._touch=null;t._windowTimer=null;if(t.options.draggable===!0){t._dragCoords={start:0,end:0}}t._sliderReadyCls="crystal-slider_ready";t._containerCls="crystal-slider__slides-container";t._trackCls="crystal-slider__track";t._slideCls="crystal-slider__slide";t._navCls="crystal-slider-nav";t._navBtnCls=t._navCls+"__btn";t._navPrevBtnCls=t._navBtnCls+"_prev";t._navNextBtnCls=t._navBtnCls+"_next";t._paginationCls="crystal-slider-pagination";t._paginationInnerCls=t._paginationCls+"__inner";t._paginationItemCls=t._paginationCls+"__item";t._paginationBtnCls=t._paginationCls+"__btn";t._activeCls="is-active";t._draggableCls="is-draggable";t._touchCls="is-touch";t._disabledCls="is-disabled";t.slidesCount=t._slides.length;t.activeSlide=t.options.activeSlide;if(t.activeSlide<1||t.activeSlide>t.slidesCount){throw new Error("Slide index "+t.activeSlide+" does not exist")}t._init()}_createClass(l,[{key:"prevSlide",value:function m(){var t=this,n=t.options;if(t.activeSlide<=1&&n.loop===!1)return;if(b(n.beforeChange)){n.beforeChange.call(t,t.activeSlide,t.slidesCount)}t.activeSlide<=1&&n.loop===!0?t.activeSlide=t.slidesCount:t.activeSlide-=1;t._setActiveSlide()}},{key:"nextSlide",value:function m(){var t=this,n=t.options;if(t.activeSlide>=t.slidesCount&&n.loop===!1)return;if(b(n.beforeChange)){n.beforeChange.call(t,t.activeSlide,t.slidesCount)}t.activeSlide>=t.slidesCount&&n.loop===!0?t.activeSlide=1:t.activeSlide+=1;t._setActiveSlide()}},{key:"goToSlide",value:function m(n){var t=this,o=this.options;if(n<1&&n>t.slidesCount)return;t._callSliderEvent(o.beforeChange,t.activeSlide,t.slidesCount);t.activeSlide=n;t._setActiveSlide()}},{key:"_setPosition",value:function m(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=this,o=t.options,p=t._track.style;t._isMove=!0;t._transformX=Math.ceil(-t._sliderWidth*(t.activeSlide-1));p[h]="translate3d("+t._transformX+"px, 0, 0)";p.webkitTransition="-webkit-transform "+o.duration+"ms "+o.easing;p.transition="transform "+o.duration+"ms "+o.easing;setTimeout(()=>{p.webkitTransition="";p.transition="";t._isMove=!1;if(n){t._callSliderEvent(o.afterChange,t.activeSlide,t.slidesCount)}},o.duration)}},{key:"_disableNavBtns",value:function m(){var t=this,n=t.options,o=t._slider,p=t._slides,q=t._nav,r=t.activeSlide;if(n.nav===!0&&n.loop===!1){q.querySelectorAll("."+t._navBtnCls).forEach(elem=>elem.classList.remove(t._disabledCls));if(r<=1){q.querySelector("."+t._navPrevBtnCls).classList.add(t._disabledCls)}else if(r>=p.length){q.querySelector("."+t._navNextBtnCls).classList.add(t._disabledCls)}}}},{key:"_setActiveSlide",value:function m(){var t=this,n=t.options,o=t._slider,p=t._slides,q=t._pagination;p.forEach(elem=>elem.classList.remove(t._activeCls));p[t.activeSlide-1].classList.add(t._activeCls);if(n.pagination){q.querySelectorAll("."+t._paginationBtnCls).forEach(elem=>elem.classList.remove(t._activeCls));q.querySelectorAll("."+t._paginationBtnCls)[t.activeSlide-1].classList.add(t._activeCls)}t._disableNavBtns();t._setPosition()}},{key:"_callSliderEvent",value:function m(n,o){if(b(n)){n.apply(this,[].concat(Array.prototype.slice.call(arguments)).shift())}}},{key:"_resetDrag",value:function m(){var t=this;t._dragCoords.start=0;t._dragCoords.end=0}},{key:"_build",value:function m(){var t=this,n=t.options,o=t._slider,p=t._slides,q=g.createElement("div"),r=g.createElement("div"),s=g.createDocumentFragment();t._transformX=Math.ceil(-t._sliderWidth*(t.activeSlide-1));o.id=t._id;o.classList.add(t._id);r.classList.add(t._trackCls);if(n.draggable){r.classList.add(t._draggableCls)}r.style.width=t._sliderWidth*t.slidesCount+"px";r.style[h]="translate3d("+t._transformX+"px, 0, 0)";q.classList.add(t._containerCls);q.appendChild(r);o.appendChild(q);p.forEach((u,v)=>{u.classList.add(t._slideCls);u.setAttribute("data-crystal-slide",v+1);u.style.width=100/t.slidesCount+"%";s.appendChild(u)});r.appendChild(s);p[t.activeSlide-1].classList.add(t._activeCls);t._container=q;t._track=r;if(n.nav===!0&&t.slidesCount>1)t._createNav();if(n.pagination===!0&&t.slidesCount>1)t._createPagination();o.classList.add(t._sliderReadyCls);t._updateWidth();t._callSliderEvent(n.onReady,t.activeSlide,t.slidesCount)}},{key:"_createPagination",value:function m(){var t=this,n=t.options,o=g.createElement("ul"),p=g.createDocumentFragment();t._pagination=g.createElement("div");t._pagination.classList.add(t._paginationCls);o.classList.add(t._paginationInnerCls);t._slides.forEach((q,r)=>{var s=g.createElement("li"),u=g.createElement("button");u.setAttribute("role","button");u.setAttribute("data-crystal-button",r+1);u.classList.add(t._paginationBtnCls);u.textContent=r+1;s.classList.add(t._paginationItemCls);s.appendChild(u);p.appendChild(s)});o.appendChild(p);t._pagination.appendChild(o);t._slider.appendChild(t._pagination);t._pagination.querySelectorAll("."+t._paginationBtnCls)[t.activeSlide-1].classList.add(t._activeCls);t._disableNavBtns()}},{key:"_createNav",value:function m(){var t=this,n=t.options,o=g.createElement("div");o.classList.add(t._navCls);o.innerHTML="\n        <button role=\"button\" class=\""+(t._navBtnCls+" "+t._navPrevBtnCls)+"\" data-crystal-button=\"prev\">"+n.navPrevVal+"</button>\n\n        <button role=\"button\" class=\""+(t._navBtnCls+" "+t._navNextBtnCls)+"\" data-crystal-button=\"next\">"+n.navNextVal+"</button>\n      ";t._nav=o;t._container.appendChild(t._nav)}},{key:"_bindEvents",value:function m(){var t=this,n=t.options,o=t._slider,p=t._track,q=[{name:t._isTouchDevice?"touchstart":"mousedown",handler:"_touchStartHandler"},{name:t._isTouchDevice?"touchmove":"mousemove",handler:"_touchMoveHandler"},{name:t._isTouchDevice?"touchend":"mouseup",handler:"_touchEndHandler"},{name:"mouseleave",handler:"_mouseLeaveHandler"}];addEventListener("resize",t._resizeHandler.bind(t));if(n.keyboard){addEventListener("keyup",t._keyUpHandler.bind(t))}o.addEventListener("click",t._mouseClickHandler.bind(t));p.addEventListener(j,t._transitionEndHandler.bind(this));if(n.draggable){q.forEach(event=>p.addEventListener(event.name,t[event.handler].bind(t)))}}},{key:"_touchStartHandler",value:function m(e){e.preventDefault();e.stopPropagation();var t=this;if(t._isMove||e.type==="mousedown"&&e.button>0)return;if(t._isTouchDevice&&e.touches.length===1){t._touch=e.changedTouches[0]}t._isTouched=!0;t._dragCoords.end=t._dragCoords.start=t._touch?t._touch.pageX:e.pageX;t._track.classList.add(t._touchCls)}},{key:"_touchMoveHandler",value:function m(e){e.preventDefault();e.stopPropagation();var t=this;if(!t._isTouched||t._isMove)return;if(t._isTouchDevice){if(e.changedTouches[0].identifier!==t._touch.identifier)return}t._dragCoords.end=t._touch?e.changedTouches[0].pageX:e.pageX;t._track.style.transform="translate3d("+(t._transformX+(t._dragCoords.end-t._dragCoords.start))+"px, 0, 0)"}},{key:"_touchEndHandler",value:function m(e){e.preventDefault();e.stopPropagation();var t=this,n=t.options,o=t._dragCoords.start,p=t._dragCoords.end,q=o-p,r=t.activeSlide;if(t._isMove)return;if(t._isTouchDevice){if(e.changedTouches[0].identifier!==t._touch.identifier)return}t._isTouched=!1;t._track.classList.remove(t._touchCls);t._resetDrag();if(!q)return;if(Math.abs(q)<=n.threshold){t._setPosition(!1);return}if(!n.loop){if(r<=1&&q<0||r>=t.slidesCount&&q>0){t._setPosition(!1);return}}o>p?t.nextSlide():t.prevSlide()}},{key:"_mouseLeaveHandler",value:function m(e){var t=this;t._touchEndHandler(e)}},{key:"_mouseClickHandler",value:function m(e){e.preventDefault();e.stopPropagation();var t=this,n=t.options,o=e.target,p=o.classList,q=+o.getAttribute("data-crystal-button");if(t._isTouched||t._isMove)return;if(p.contains(t._navBtnCls)){o.getAttribute("data-crystal-button")==="prev"?t.prevSlide():t.nextSlide()}if(p.contains(t._paginationBtnCls)&&q!==t.activeSlide)t.goToSlide(q)}},{key:"_transitionEndHandler",value:function m(){var t=this;t._track.classList.remove(t._touchCls)}},{key:"_keyUpHandler",value:function m(e){e.preventDefault();e.stopPropagation();var t=this,n={left:37,right:39};if(t._isMove)return;switch(e.keyCode){case n.left:t.prevSlide();break;case n.right:t.nextSlide();break;}}},{key:"_updateWidth",value:function m(){var t=this,n=t._track;clearTimeout(t._windowTimer);t._windowTimer=setTimeout(()=>{t.windowWidth=a.innerWidth;t._sliderWidth=t._slider.getBoundingClientRect().width;t._transformX=Math.ceil(-t._sliderWidth*(t.activeSlide-1));n.style.width=t._sliderWidth*t.slidesCount+"px";n.style[h]="translate3d("+t._transformX+"px, 0, 0)"},50)}},{key:"_resizeHandler",value:function m(){var t=this;t._updateWidth()}},{key:"_init",value:function m(){var t=this;t._build();t._bindEvents()}}]);return l}();a.CrystalSlider=k;function b(l){return l&&{}.toString.call(l)==="[object Function]"}function c(){return!!("ontouchstart"in a||navigator.maxTouchPoints)}function d(){var l=g.createElement("div");if(l.style.transform===null){if(l.style.WebkitTransform!==void 0){return"WebkitTransform"}}return"transform"}function f(){var l=g.createElement("div"),m={transition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in m){if(m.hasOwnProperty(i)&&l.style[i]!==void 0)return m[i]}}})(window);